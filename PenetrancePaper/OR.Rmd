# OR

```{r}
HCM$Var <- HCM$AC_ALL_HCM
HCM$NoVar <- HCM$AN_ALL_HCM - HCM$AC_ALL_HCM
HCM$Var2p <- HCM$gnukb_AC
HCM$NoVarp <- HCM$gnukb_AN - HCM$gnukb_AC

HCM[(ncol(HCM)+1)] <- apply(HCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(HCM)-3):(ncol(HCM))]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$estimate
              })

HCM[(ncol(HCM)+1)] <- apply(HCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(HCM)-3-1):(ncol(HCM)-1)]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$p.value
              })

HCM[(ncol(HCM)+1)] <- apply(HCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(HCM)-3-2):(ncol(HCM)-2)]), ncol=2, byrow=T)
            fisher.test(tbl, alternative="two.sided")$conf.int[1]
              })

HCM[(ncol(HCM)+1)] <- apply(HCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(HCM)-3-3):(ncol(HCM)-3)]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$conf.int[2]
              })

HCM <- data.frame(HCM)
colnames(HCM)[(ncol(HCM)-3):(ncol(HCM))] <- c("OR", "pvalOR", "lciOR", "uciOR")
HCM$pvalOR_BF <- p.adjust(HCM$pvalOR, method="bonferroni")
HCM$pvalOR_FDR <- p.adjust(HCM$pvalOR, method="fdr")
HCM$sigBF <- (HCM$pvalOR_BF <0.05)
HCM$sigFDR <- (HCM$pvalOR_FDR <0.05)
table(HCM$sigBF, HCM$sigFDR)
#        FALSE TRUE
#  FALSE    82   86 #FDR
#   TRUE      0   89 #BF

###DCM
DCM$Var <- DCM$AC_ALL_DCM
DCM$NoVar <- DCM$AN_ALL_DCM - DCM$AC_ALL_DCM
DCM$Var2p <- DCM$gnukb_AC
DCM$NoVarp <- DCM$gnukb_AN - DCM$gnukb_AC

DCM[(ncol(DCM)+1)] <- apply(DCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(DCM)-3):(ncol(DCM))]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$estimate
              })

DCM[(ncol(DCM)+1)] <- apply(DCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(DCM)-3-1):(ncol(DCM)-1)]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$p.value
              })

DCM[(ncol(DCM)+1)] <- apply(DCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(DCM)-3-2):(ncol(DCM)-2)]), ncol=2, byrow=T)
            fisher.test(tbl, alternative="two.sided")$conf.int[1]
              })

DCM[(ncol(DCM)+1)] <- apply(DCM, 1, 
      function(x) {
          tbl <- matrix(as.numeric(x[(ncol(DCM)-3-3):(ncol(DCM)-3)]), ncol=2, byrow=T)
          fisher.test(tbl, alternative="two.sided")$conf.int[2]
              })

DCM <- data.frame(DCM)
colnames(DCM)[(ncol(DCM)-3):(ncol(DCM))] <- c("OR", "pvalOR", "lciOR", "uciOR")
DCM$pvalOR_BF <- p.adjust(DCM$pvalOR, method="bonferroni")
DCM$pvalOR_FDR <- p.adjust(DCM$pvalOR, method="fdr")
DCM$sigBF <- (DCM$pvalOR_BF <0.05)
DCM$sigFDR <- (DCM$pvalOR_FDR <0.05)
table(DCM$sigBF, DCM$sigFDR)
#        FALSE TRUE
#  FALSE    12   29 #FDR
#  TRUE      0   18 #BF
```
